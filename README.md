# 113-2-DeepLearning-HW2-Transfer-Learning
此為 113-2 工工所的深度學習的第二份作業，利用Transfer Learning的概念來進行瑕疵檢測

## Author：國立陽明交通大學 資訊管理與財務金融學系財務金融所碩一 313707043 翁智宏

本次是深度學習課程的第二份作業，利用Transfer Learning的概念來進行瑕疵檢測。

**Questions**
本次作業請各位同學使用Transfer Learning的概念來進行瑕疵檢測，請依照以下敘述訓練模型，並在訓練完模型後回答以下的問題，共有3大題。

**Datasets**
這個資料集中的影像展示了常見的膠囊外觀，一共有6個類別，包含正常和其他五種類型的瑕疵（如凹陷、裂痕、污染等），正常類別約有200張圖片，另外五個瑕疵類別則各有約20張圖片。請同學自行切分出訓練集和測試集。

---

## 題目

1、請分別使用「自建的ResNet」與「有預訓練過的ResNet」對資料集進行分類，並比較兩者的結果。接著用相同流程比較其他的預訓練模型與有預訓練過的ResNet。 

(1) 建構自定義的ResNet模型：請參考ResNet的原始架構用PyTorch從頭開始定義一個ResNet模型（如第一次作業的實作），並用作業的資料集進行訓練和預測。 

(2) 使用預訓練的ResNet模型：請使用已經預訓練的ResNet（例如：torchvision.models 或 timm 等庫中提供的模型），一樣用作業的資料集進行微調和預測。 

(3) 比較自己建立的ResNet與預訓練ResNet的表現：請將兩者在訓練速度、訓練損失、收斂時機、準確率等各方面的差異繪製成圖跟表格來進行比較，讓結果更加直觀，並針對結果進行簡短說明。 

(4) 比較不同預訓練模型的表現：請再使用一個ResNet以外的預訓練模型進行訓練，並與預訓練ResNet進行比較。同樣需將兩者的差異繪製成圖表來呈現，並簡要說明你認為哪一個模型表現較佳，以及它表現較佳的理由為何。

2、在實際的製造環境中，異常樣本通常非常稀少且難以蒐集，對樣本進行標註也需要仰賴專業知識，並伴隨高昂的人力與時間成本。因此，要取得完整且多樣的異常資料相當困難。 

(1) 在上述情境中無法像一般分類任務那樣收集足夠的異常樣本，請問此時應採用何種分類設定來訓練模型？

(2) 承上題，請說明在資料集中僅包含大量正常樣本而幾乎沒有異常樣本的情況下，瑕疵檢測模型通常會採取什麼樣的訓練策略？ 

(3) 請舉出一種常見的瑕疵檢測訓練方法，是能夠只使用正常樣本或少量異常樣本就有效地訓練模型，並簡單講解該方法的原理。請注意，答案應聚焦於該方法所屬的訓練類型，而非具體的模型名稱。例如：DRAEM的訓練是屬於「重建方法」，請回答「重建方法」而非DRAEM，並說明重建方法是如何運作的。 

3、在瑕疵檢測任務中，除了要對整張圖片進行正常／異常分類外，若圖片中存在異常，我們也希望模型能準確地指出瑕疵所在的位置或範圍。請問這種需求還可以透過哪些類型的電腦視覺任務來達成？寫出一種並簡短說明該任務的基本概念，比方說如何標示異常的位置。

## 📌 第一題：模型比較（取 Validation Accuracy 最高回合）

### ✅ 比較一：自定義 ResNet vs 預訓練 ResNet18

| 指標項目   | 自定義 ResNet | ResNet18 (預訓練) |
|------------|----------------|------------------|
| 早停回合   | 125 回合        | 225 回合          |
| 訓練速度   | 21.97 分        | 44.82 分          |
| 訓練損失   | 0.4827         | 0.0024           |
| 收斂時機   | 起伏很大、不穩定 | 約在第 30 回合     |
| 驗證準確率 | 71.21%         | **90.91%**       |

🔎 **分析：**  
ResNet18 模型整體表現明顯優於自定義 ResNet。前者雖然單回合訓練時間較長，但收斂速度與穩定性更佳，能在小資料集上展現強大的泛化能力。

![custom vs resnet18 accuracy](Image/"custom vs resnet18 accuracy.png")
![custom vs resnet18 loss](Image/"custom vs resnet18 loss.png")

---

### ✅ 比較二：ResNet18 vs EfficientNet-B0

| 指標項目   | ResNet18       | EfficientNet-B0  |
|------------|----------------|------------------|
| 早停回合   | 225 回合        | 230 回合          |
| 訓練速度   | 44.82 分        | **34.03 分**     |
| 訓練損失   | **0.0024**     | 0.0106           |
| 收斂時機   | 約第 30 回合     | 約第 15 回合       |
| 驗證準確率 | **90.91%**     | 89.39%           |

🔎 **分析：**  
兩者在準確率上表現相近，但 EfficientNet-B0 訓練速度快、收斂更早，若以效率為考量更具優勢；若追求極致準確率與低損失，ResNet18 表現稍勝。

![resnet18 vs efficientnet accuracy](Image/"resnet18 vs effieinet accuracy.png")
![resnet18 vs efficientnet loss](Image/"resnet18 vs effieinet loss.png")
---

## 🧠 第二題：異常檢測方法概述

### (1) Autoencoder 重建方法

- 僅使用正常樣本訓練，模型學會重建正常資料的特徵。
- 測試階段：異常樣本無法正確重建 → 重建誤差高 → 判定為異常。

### (2) 訓練策略分類

- 只用正常樣本訓練 → **單類分類 / 重建式異常檢測**
- 又稱為 **Self-Supervised Learning**

### (3) 方法舉例：重建方法

| 階段     | 描述 |
|----------|------|
| 訓練階段 | 使用正常樣本訓練模型學會「壓縮再重建」輸入 |
| 測試階段 | 使用重建誤差判斷輸入是否異常 |

---

## 🧠 第三題：異常定位方法

### 任務類型：語意分割（Semantic Segmentation）

- 逐像素進行分類，可應用於異常區域分割。
- 模型輸出異常遮罩（mask）圖，並可疊加原圖進行可視化。

